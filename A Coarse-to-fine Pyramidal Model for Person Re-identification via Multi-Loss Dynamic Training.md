# A Coarse-to-fine Pyramidal Model for Person Re-identification via Multi-Loss Dynamic Training

# 摘要
      大多数现有的行人重识别方法高度依赖于精确的边界框，这些边界框可以使图像彼此对齐。然而，由于不可避免的挑战性场景，当前的检测模型往往会输出不准确的边界框，这必然会恶化这些Re-ID算法的性能。本文提出了一种新的由粗到细的金字塔模型，该模型不仅融合了局部和全局信息，而且融合了它们之间的渐进线索。即使图像对没有对齐的情况下，金字塔模型仍然能够在不同的尺度上匹配视觉线索，然后搜索相同身份的正确图像。此外，为了学习识别性的身份表示，我们探索了一种动态训练方案，以无缝地统一两种损失，并提取它们之间适当的共享信息。实验结果表明，该方法在三个数据集上都达到了最先进的结果，值得注意的是，在最具挑战性的数据集CUHK03上，我们的方法超过了目前的最佳方法9.5%。
# 1、Introduction
      行人重识别旨在将在不同地点捕获的同一个人的图像关联起来，从而促进基于视觉的智能零售和安全监控中使用的跨摄像头跟踪技术。一般来说，行人检测系统之后，行人重识别被认为是下一个制高点的任务，因此行人重识别的基本假设是检测模型能够提供精确且高度对齐的边界框。尽管最近取得了很大的进展，但由于局部模型的潜在问题和训练的困难，现有方法的性能改进空间有限。
      基于局部的模型的缺点：众所周知，基于局部的模型通常可以在许多计算机视觉任务中实现卓越的性能，因为这些模型对一些不可避免的挑战（如遮挡和局部变化）具有潜在的鲁棒性。事实上，这些挑战严重影响了PersonReID在实际应用程序中的性能。因此，最近提出的PCB模型可以达到最先进的结果。PCB模型简单但非常有效甚至可以超过其他学习的部分模型。然而，在PCB中，将主干网的特征图直接划分成固定数量的部分，严格限制了进一步提高性能的能力。它至少有两个主要缺点，但不限于：1）整体性能严重依赖于强大而健壮的行人检测模型输出精确的边界框，否则部件无法很好地对齐。然而，在大多数具有挑战性的场景中，当前的检测模型不足以做到这一点。2）全局信息也是识别和验证的重要线索，在该模型中被完全忽略，而全局特征通常对细微的视图变化和内部变化具有鲁棒性。
      多任务训练的难点：最近的研究表明，多任务学习能够通过在任务之间提取适当的共享信息来实现优越的性能。在不损失一般性的情况下，“损失”和“任务”将交替使用。事实上，许多现有的Re-ID方法也可以从多损失方案中获益，以提高性能。一般来说，大多数多任务方法都选择在整个训练过程中使用固定的平衡参数来衡量损失。1）性能高度依赖于合适的参数，但选择合适的参数无疑是一项耗时耗力的工作。2）随着模型的逐步更新，不同任务的难度实际上发生了变化，导致不同迭代的合适参数发生了真正的变化。3）更重要的是，由于具体考虑，针对不同损失的抽样策略通常是不同的。例如，对于三重损失的硬采样会抑制另一个识别损失任务的作用。
      针对上述问题，本文提出了一种基于主干网提取的特征图的粗到细的金字塔模型，用于行人重识别。首先，金字塔实际上是一组具有特定由粗到细结构的三维子特征图，其中每个特征图捕获不同空间尺度的判别信息。然后，使用卷积层来减小金字塔中每个分离分支的特征尺寸。第三，对于每个分支，SoftMax函数的识别损失独立地应用于一个全连接层，该层将特征作为输入。此外，所有分支的特征将连接起来形成身份特征，为此定义了三重丢失，以学习更多的区分特征。为了使这两种损失能顺利地融合，研究了一种具有两种采样策略的动态训练方案，以优化深部神经网络的参数。最后，将学习到的身份表示用于人的图像匹配、检索和再识别。
      综上所述，本文的贡献有三个方面：1）为了缓和对强检测模型的要求，我们提出了一种新的由粗到细金字塔模型，它不仅融合了局部和全局信息，而且整合了它们之间的渐进线索。2）为了最大限度地利用不同的损失，我们探索了一种动态训练方案，将两种损失无缝地统一起来，并提取出它们之间适当的共享信息，用于学习有判别力的身份特征。3）该方法在三个数据集上都达到了最先进的结果，最显著的是，我们的方法在数据集CUHK03上超过了当前的最佳方法9.5%。
